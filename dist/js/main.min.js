Site={mobileThreshold:601,init:function(){var n=this;Site.Router.init(),$(window).resize(function(){n.onResize()}),$(document).ready(function(){Site.Shapes.init(),Site.Minimap.init(),Site.Map.init(),Site.Fades.init(),Site.Nav.init()})},onResize:function(){},fixWidows:function(){$(".js-fix-widows").each(function(){var n=$(this).html();n=n.replace(/ ([^ ]*)$/,"&nbsp;$1"),$(this).html(n)})}},Site.Nav={init:function(){this.bind()},bind:function(){var n=this;$("#header-name").on("click",function(){n.reset()})},reset:function(){Site.Map.moveMap(Site.Map.window.width*-1,Site.Map.window.height*-1),Site.Router.resetContent(),Site.Router.cleanUrl()}},Site.Router={init:function(){var n=this;n.bind(),location.hash&&n.loadRoute(n.parseHash(location.hash))},bind:function(){var n=this;$(window).on("hashchange",function(){n.loadRoute(n.parseHash(location.hash))})},loadRoute:function(n){var t=this;n&&(t.resetContent(),$('.page-content[data-slug="'+n+'"]').addClass("page-content-active"),t.setMenuActive(n))},resetContent:function(){$(".page-content").removeClass("page-content-active"),$(".header-menu-active").removeClass("header-menu-active")},setMenuActive:function(n){var t=$('.header-menu-item[data-slug="'+n+'"]');$(".header-menu-active").removeClass("header-menu-active"),t.addClass("header-menu-active")},parseHash:function(n){return n.substr(3)},cleanUrl:function(){window.location.hash="",history.pushState({},"","./")}},Site.Shapes={$mapPattern:$(".map-pattern"),$patterns:[$("#pattern-1"),$("#pattern-2"),$("#pattern-3"),$("#pattern-4"),$("#pattern-5")],patternMin:0,patternMax:4,currentPattern:0,timer:null,interval:1e3,animating:!1,init:function(){var n=this;n.showPattern();var t=document.getElementById("map");t.addEventListener("startpan",function(){n.startAnimation()}),t.addEventListener("stoppan",function(){n.stopAnimation()})},showPattern:function(){var n=this;n.currentPattern=Math.floor(Math.random()*(n.patternMax-n.patternMin+1))+n.patternMin,n.$patterns[n.currentPattern].addClass("show")},changePattern:function(){var n=this;n.$mapPattern.removeClass("show"),n.currentPattern>=n.patternMax?n.currentPattern=n.patternMin:n.currentPattern++,n.$patterns[n.currentPattern].addClass("show")},playAnimation:function(){var n=this;if(!n.animating)return!1;var t=(new Date).getTime(),e=t-n.startTime;e>=n.interval&&(n.changePattern(),n.startTime=(new Date).getTime()),n.timer=window.requestAnimationFrame(n.playAnimation.bind(n))},startAnimation:function(){var n=this;n.startTime=(new Date).getTime()-n.interval,n.animating=!0,n.playAnimation()},stopAnimation:function(){var n=this;n.animating=!1,window.cancelAnimationFrame(n.timer)}},Site.Map={panZoneSize:150,panSpeed:.04,panDelay:100,panning:!1,window:{},center:{},mouse:{},mapPosition:!1,pointerInHeader:!1,init:function(){var n=this;n.getWindowSize(),n.map=document.getElementById("map"),n.geolocation(),n.setPanZones(),document.addEventListener("mousemove",n.handleMouseMove.bind(n)),document.body.addEventListener("mouseleave",n.stopPanning.bind(n)),n.bindHeaderMouseOver()},getWindowSize:function(){var n=this;n.window={width:window.innerWidth,height:window.innerHeight},n.window.center={x:n.window.width/2,y:n.window.height/2}},setPanZones:function(){var n=this;n.panZones={up:{min:0,max:n.panZoneSize},down:{min:n.window.height-n.panZoneSize,max:n.window.height},left:{min:0,max:n.panZoneSize},right:{min:n.window.width-n.panZoneSize,max:n.window.width}}},handleMouseMove:function(n){var t=this;t.mouse.x=n.clientX,t.mouse.y=n.clientY,t.isInsidePanZone()&&!t.panning?t.triggerPanning():t.panning&&!t.isInsidePanZone()&&t.stopPanning()},stopPanning:function(){var n=this;n.panning=!1,clearTimeout(n.delayTimeout),n.stopPanEvent()},isInsidePanZone:function(){var n=this;if(n.mouseOnHeader)return!1;var t=n.mouse.x,e=n.mouse.y;return t>=n.panZones.left.min&&t<=n.panZones.left.max||t>=n.panZones.right.min&&t<=n.panZones.right.max||e>=n.panZones.up.min&&e<=n.panZones.up.max||e>=n.panZones.down.min&&e<=n.panZones.down.max},triggerPanning:function(){var n=this;n.panning=!0,n.delayTimeout=setTimeout(function(){n.startPanEvent(),window.requestAnimationFrame(n.pan.bind(n))},n.panDelay)},startPanEvent:function(){var n=this,t=new CustomEvent("startpan",{detail:{map:{position:{x:n.mapPosition[4],y:n.mapPosition[5]}}}});n.map.dispatchEvent(t)},stopPanEvent:function(){var n=this,t=new CustomEvent("stoppan",{detail:{map:{position:{x:n.mapPosition[4],y:n.mapPosition[5]}}}});n.map.dispatchEvent(t)},pan:function(){var n=this;if(!n.panning)return!1;var t=n.angleFromCenter(),e=n.distanceFromCenter()*n.panSpeed;n.mapPosition||(n.mapPosition=n.getElemPosition(n.map));var i=n.mapPosition[4]+e*Math.cos(t),a=n.mapPosition[5]+e*Math.sin(t);n.moveMap(i,a),window.requestAnimationFrame(n.pan.bind(n))},geolocation:function(){var n=this;if(WP.clientGeolocation){if(WP.clientGeolocation.latitude&&WP.clientGeolocation.longitude){var t=Number(WP.clientGeolocation.longitude),e=Number(WP.clientGeolocation.latitude),i=t+180,a=e-90,o=i*(n.window.width*-2)/360,r=a*(2*n.window.height)/180;n.moveMap(o,r)}}else console.log("Geolocation not returned by the server")},moveMap:function(n,t){var e=this;n>=0&&(n=0),n<=e.window.width*-2&&(n=e.window.width*-2),t>=0&&(t=0),t<=e.window.height*-2&&(t=e.window.height*-2),e.mapPosition||(e.mapPosition=e.getElemPosition(e.map)),e.mapPosition[4]=n,e.mapPosition[5]=t,e.map.style.transform="matrix("+e.mapPosition.toString()+")",Site.Minimap.moveIndicator(n,t)},distanceFromCenter:function(){var n=this,t=Math.pow(n.window.center.x-n.mouse.x,2),e=Math.pow(n.window.center.y-n.mouse.y,2),i=Math.sqrt(t+e);return i},angleFromCenter:function(){var n=this,t=n.window.center.y-this.mouse.y,e=n.window.center.x-this.mouse.x,i=Math.atan2(t,e);return i},getElemPosition:function(n){var t=getComputedStyle(n).transform;return t=t.replace(/3d|matrix|\(|\)|\s|/g,"").split(","),t=t.map(function(n){return parseInt(n,10)})},bindHeaderMouseOver:function(){for(var n=this,t=document.querySelectorAll("#header > *"),e=0;e<t.length;e++){var i=t[e];i.addEventListener("mouseenter",n.mouseEntersHeader.bind(n)),i.addEventListener("mouseleave",n.mouseLeavesHeader.bind(n))}},mouseEntersHeader:function(){var n=this;n.mouseOnHeader=!0},mouseLeavesHeader:function(){var n=this;n.mouseOnHeader=!1}},Site.Fades={$textContent:$("#main-content"),$mapContent:$(".map-block-content"),isPanning:!1,isHoveringText:!1,init:function(){var n=this;n.handleMapPanning(),n.handleTextHover()},handleMapPanning:function(){var n=this,t=document.getElementById("map");t.addEventListener("startpan",function(){n.isPanning=!0,n.$textContent.addClass("fade-element"),n.$mapContent.removeClass("fade-element")}),t.addEventListener("stoppan",function(){n.isPanning=!1,n.$textContent.removeClass("fade-element"),n.isHoveringText&&n.$mapContent.addClass("fade-element")})},handleTextHover:function(){var n=this;n.$textContent.hover(function(){n.isHoveringText=!0,n.isPanning||n.$mapContent.addClass("fade-element")},function(){n.isHoveringText=!1,n.$mapContent.removeClass("fade-element")})}},Site.Minimap={minimapScale:.03,indicatorPosition:!1,init:function(){var n=this;n.minimapIndicator=document.getElementById("minimap-indicator"),n.bindClick()},bindClick:function(){var n=this;$(".minimap-button").on("click",function(){n.handleClick(this)})},handleClick:function(n){var t=$(n).attr("data-col"),e=$(n).attr("data-row"),i=t*Site.Map.window.width*-1,a=e*Site.Map.window.height*-1;Site.Map.moveMap(i,a)},moveIndicator:function(n,t){var e=this,i=n*-e.minimapScale,a=t*-e.minimapScale;e.indicatorPosition||(e.indicatorPosition=Site.Map.getElemPosition(e.minimapIndicator)),e.indicatorPosition[4]=i,e.indicatorPosition[5]=a,e.minimapIndicator.style.transform="matrix("+e.indicatorPosition.toString()+")"}},Site.init();
//# sourceMappingURL=main.min.js.map
