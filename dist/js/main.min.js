Site={$window:$(window),mobileThreshold:1024,scrollSpeed:300,init:function(){var n=this;n.setIsMobileWidth(),Site.Router.init(),n.$window.resize(function(){n.onResize(),Site.Nav.onResize()}),$(document).ready(function(){Site.Shapes.init(),Site.Minimap.init(),Site.Coordinates.init(),Site.Map.init(),Site.Fades.init(),Site.Nav.init()})},onResize:function(){var n=this;n.setIsMobileWidth(),Site.Map.onResize()},setIsMobileWidth:function(){var n=this;n.$window.width()>=n.mobileThreshold?n.isMobileWidth=!1:n.isMobileWidth=!0},fixWidows:function(){$(".js-fix-widows").each(function(){var n=$(this).html();n=n.replace(/ ([^ ]*)$/,"&nbsp;$1"),$(this).html(n)})}},Site.Nav={init:function(){var n=this;n.$header=$("#header"),n.setScrollOffset(),n.bind()},bind:function(){var n=this;$("#header-name").on("click",function(){Site.isMobileWidth?$("#main-content").toggleClass("mobile-menu-active"):n.reset()}),$(".mobile-menu-item").on("click",function(){var t=$(this).data("slug"),e=$(".page-content[data-slug="+t+"]");$("#main-content").removeClass("mobile-menu-active"),$("body").stop().animate({scrollTop:e.offset().top-n.scrollOffset},Site.scrollSpeed,"swing")})},onResize:function(){var n=this;n.setScrollOffset()},setScrollOffset:function(){var n=this;n.scrollOffset=(n.$header.outerHeight()-n.$header.height())/2+n.$header.height()},reset:function(){Site.Map.moveMap(Site.Map.window.width*-1,Site.Map.window.height*-1),Site.Router.resetContent(),Site.Router.cleanUrl()}},Site.Router={init:function(){var n=this;n.bind(),location.hash&&n.loadRoute(n.parseHash(location.hash))},bind:function(){var n=this;Site.$window.on("hashchange",function(){n.loadRoute(n.parseHash(location.hash))})},loadRoute:function(n){var t=this;n&&(t.resetContent(),$('.page-content[data-slug="'+n+'"]').addClass("page-content-active"),t.setMenuActive(n))},resetContent:function(){$(".page-content").removeClass("page-content-active"),$(".header-menu-active").removeClass("header-menu-active")},setMenuActive:function(n){var t=$('.header-menu-item[data-slug="'+n+'"]');$(".header-menu-active").removeClass("header-menu-active"),t.addClass("header-menu-active")},parseHash:function(n){return n.substr(3)},cleanUrl:function(){window.location.hash="",history.pushState({},"","./")}},Site.Shapes={$mapPattern:$(".map-pattern"),$patterns:[$("#pattern-1"),$("#pattern-2"),$("#pattern-3"),$("#pattern-4"),$("#pattern-5")],patternMin:0,patternMax:4,currentPattern:0,timer:null,interval:750,animating:!1,init:function(){var n=this;n.showPattern();var t=document.getElementById("map");t.addEventListener("startpan",function(){n.startAnimation()}),t.addEventListener("stoppan",function(){n.stopAnimation()})},showPattern:function(){var n=this;n.currentPattern=Math.floor(Math.random()*(n.patternMax-n.patternMin+1))+n.patternMin,n.$patterns[n.currentPattern].addClass("show")},changePattern:function(){var n=this;n.$mapPattern.removeClass("show"),n.currentPattern>=n.patternMax?n.currentPattern=n.patternMin:n.currentPattern++,n.$patterns[n.currentPattern].addClass("show")},playAnimation:function(){var n=this;if(!n.animating)return!1;var t=(new Date).getTime(),e=t-n.startTime;e>=n.interval&&(n.changePattern(),n.startTime=(new Date).getTime()),n.timer=window.requestAnimationFrame(n.playAnimation.bind(n))},startAnimation:function(){var n=this;n.startTime=(new Date).getTime()-n.interval,n.animating=!0,n.playAnimation()},stopAnimation:function(){var n=this;n.animating=!1,window.cancelAnimationFrame(n.timer)}},Site.Map={panZoneSize:48,panSpeed:.04,panDelay:100,panning:!1,window:{},center:{},mouse:{},mapPosition:!1,pointerInHeader:!1,init:function(){var n=this;n.getWindowSize(),n.map=document.getElementById("map"),n.geolocation(),n.setPanZones(),document.addEventListener("mousemove",n.handleMouseMove.bind(n)),document.body.addEventListener("mouseleave",n.stopPanning.bind(n)),n.bindHeaderMouseOver()},onResize:function(){var n=this;n.getWindowSize(),n.setPanZones()},getWindowSize:function(){var n=this;n.window={width:window.innerWidth,height:window.innerHeight},n.window.center={x:n.window.width/2,y:n.window.height/2}},setPanZones:function(){var n=this;n.panZones={up:{min:0,max:n.panZoneSize},down:{min:n.window.height-n.panZoneSize,max:n.window.height},left:{min:0,max:n.panZoneSize},right:{min:n.window.width-n.panZoneSize,max:n.window.width}}},handleMouseMove:function(n){var t=this;t.mouse.x=n.clientX,t.mouse.y=n.clientY,t.isInsidePanZone()&&!t.panning?t.triggerPanning():t.panning&&!t.isInsidePanZone()&&t.stopPanning()},stopPanning:function(){var n=this;n.panning=!1,clearTimeout(n.delayTimeout),n.stopPanEvent()},isInsidePanZone:function(){var n=this;if(n.mouseOnHeader)return!1;var t=n.mouse.x,e=n.mouse.y;return t>=n.panZones.left.min&&t<=n.panZones.left.max||t>=n.panZones.right.min&&t<=n.panZones.right.max||e>=n.panZones.up.min&&e<=n.panZones.up.max||e>=n.panZones.down.min&&e<=n.panZones.down.max},triggerPanning:function(){var n=this;n.panning=!0,n.delayTimeout=setTimeout(function(){n.startPanEvent(),window.requestAnimationFrame(n.pan.bind(n))},n.panDelay)},startPanEvent:function(){var n=this,t=new CustomEvent("startpan",{detail:{map:{position:{x:n.mapPosition[4],y:n.mapPosition[5]}}}});n.map.dispatchEvent(t)},stopPanEvent:function(){var n=this,t=new CustomEvent("stoppan",{detail:{map:{position:{x:n.mapPosition[4],y:n.mapPosition[5]}}}});n.map.dispatchEvent(t)},pan:function(){var n=this;if(!n.panning)return!1;var t=n.angleFromCenter(),e=n.distanceFromCenter()*n.panSpeed;n.mapPosition||(n.mapPosition=n.getElemPosition(n.map));var i=n.mapPosition[4]+e*Math.cos(t),a=n.mapPosition[5]+e*Math.sin(t);n.moveMap(i,a),window.requestAnimationFrame(n.pan.bind(n))},geolocation:function(){var n=this;if(WP.clientGeolocation){if(WP.clientGeolocation.latitude&&WP.clientGeolocation.longitude){var t=Number(WP.clientGeolocation.longitude),e=Number(WP.clientGeolocation.latitude),i=t+180,a=e-90,o=i*(n.window.width*-2)/360,s=a*(2*n.window.height)/180;n.moveMap(o,s)}}else console.log("Geolocation not returned by the server")},moveMap:function(n,t){var e=this;n>=0&&(n=0),n<=e.window.width*-2&&(n=e.window.width*-2),t>=0&&(t=0),t<=e.window.height*-2&&(t=e.window.height*-2),e.mapPosition||(e.mapPosition=e.getElemPosition(e.map)),e.mapPosition[4]=n,e.mapPosition[5]=t,e.map.style.transform="matrix("+e.mapPosition.toString()+")",e.triggerMoveEvent(n,t)},triggerMoveEvent:function(n,t){var e=this,i=new CustomEvent("movemap",{detail:{map:{position:{x:n,y:t}}}});e.map.dispatchEvent(i)},distanceFromCenter:function(){var n=this,t=Math.pow(n.window.center.x-n.mouse.x,2),e=Math.pow(n.window.center.y-n.mouse.y,2),i=Math.sqrt(t+e);return i},angleFromCenter:function(){var n=this,t=n.window.center.y-this.mouse.y,e=n.window.center.x-this.mouse.x,i=Math.atan2(t,e);return i},getElemPosition:function(n){var t=getComputedStyle(n).transform;return t=t.replace(/3d|matrix|\(|\)|\s|/g,"").split(","),t=t.map(function(n){return parseInt(n,10)})},bindHeaderMouseOver:function(){for(var n=this,t=document.querySelectorAll("#header > *"),e=0;e<t.length;e++){var i=t[e];i.addEventListener("mouseenter",n.mouseEntersHeader.bind(n)),i.addEventListener("mouseleave",n.mouseLeavesHeader.bind(n))}},mouseEntersHeader:function(){var n=this;n.mouseOnHeader=!0},mouseLeavesHeader:function(){var n=this;n.mouseOnHeader=!1}},Site.Fades={$textContent:$("#main-content"),$mapContent:$(".map-block-content"),isPanning:!1,isHoveringText:!1,init:function(){var n=this;n.handleMapPanning(),n.handleTextHover()},handleMapPanning:function(){var n=this,t=document.getElementById("map");t.addEventListener("startpan",function(){n.isPanning=!0,n.$textContent.addClass("fade-element"),n.$mapContent.removeClass("fade-element")}),t.addEventListener("stoppan",function(){n.isPanning=!1,n.$textContent.removeClass("fade-element"),n.isHoveringText&&n.$mapContent.addClass("fade-element")})},handleTextHover:function(){var n=this;n.$textContent.hover(function(){n.isHoveringText=!0,n.isPanning||n.$mapContent.addClass("fade-element")},function(){n.isHoveringText=!1,n.$mapContent.removeClass("fade-element")})}},Site.Minimap={minimapScale:.03,indicatorPosition:!1,init:function(){var n=this;n.minimapIndicator=document.getElementById("minimap-indicator"),n.bindClick(),n.bindMapMove()},bindClick:function(){var n=this;$(".minimap-button").on("click",function(){n.handleClick(this)})},bindMapMove:function(){var n=this,t=document.getElementById("map");t.addEventListener("movemap",n.moveIndicator.bind(n))},handleClick:function(n){var t=$(n).attr("data-col"),e=$(n).attr("data-row"),i=t*Site.Map.window.width*-1,a=e*Site.Map.window.height*-1,o=$("#map");o.addClass("slow-pan"),setTimeout(function(){o.removeClass("slow-pan")},300),Site.Map.moveMap(i,a)},moveIndicator:function(n){var t=this,e=n.detail.map.position.x,i=n.detail.map.position.y,a=e*-t.minimapScale,o=i*-t.minimapScale;t.indicatorPosition||(t.indicatorPosition=Site.Map.getElemPosition(t.minimapIndicator)),t.indicatorPosition[4]=a,t.indicatorPosition[5]=o,t.minimapIndicator.style.transform="matrix("+t.indicatorPosition.toString()+")"}},Site.Coordinates={secondsDecimalsSize:3,init:function(){var n=this;n.coordinatesHolder=document.getElementById("lat-long"),n.bindMapMove()},bindMapMove:function(){var n=this,t=document.getElementById("map");t.addEventListener("movemap",n.updateCoordinates.bind(n))},updateCoordinates:function(n){var t=this,e=n.detail.map.position.x,i=n.detail.map.position.y,a=t.convertToCoordinates(e,i);t.coordinatesHolder.innerHTML=a.lat+", "+a.long},convertToCoordinates:function(n,t){var e=this,i=Site.Map.window.width,a=Site.Map.window.height,o=n/(i*-2)*360-180,s=t/(a*-2)*180-90;o=e.convertToDMS(o),s=e.convertToDMS(s);var r={lat:s,long:o};return r},convertToDMS:function(n){var t=this,e=Math.floor(n),i=Math.floor(60*(n-e)),a=3600*(n-e-i/60);return a=a.toFixed(t.secondsDecimalsSize),e+"Â° "+i+"' "+a+'"'}},Site.init();
//# sourceMappingURL=main.min.js.map
