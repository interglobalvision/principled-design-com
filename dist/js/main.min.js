Site={mobileThreshold:1024,scrollSpeed:300,init:function(){var t=this;t.mapElement=document.getElementById("map"),t.$window=$(window),t.getWindowSize(),t.setIsMobileWidth(),Site.Router.init(),t.$window.resize(function(){t.onResize(),Site.Nav.onResize()}),$(document).ready(function(){Site.Shapes.init(),Site.Minimap.init(),Site.Coordinates.init(),Site.Map.init(),Site.Fades.init(),Site.Nav.init(),Site.Orientation.init()})},getWindowSize:function(){var t=this;t.window={width:window.innerWidth,height:window.innerHeight},t.window.center={x:t.window.width/2,y:t.window.height/2}},onResize:function(){var t=this;t.getWindowSize(),t.setIsMobileWidth(),Site.Map.onResize()},setIsMobileWidth:function(){var t=this;t.window.width>=t.mobileThreshold?t.isMobileWidth=!1:t.isMobileWidth=!0},fixWidows:function(){$(".js-fix-widows").each(function(){var t=$(this).html();t=t.replace(/ ([^ ]*)$/,"&nbsp;$1"),$(this).html(t)})}},Site.Nav={init:function(){var t=this;t.$header=$("#header"),t.setScrollOffset(),t.bind()},bind:function(){var t=this;$("#header-name").on("click",function(){Site.isMobileWidth?$("#main-content").toggleClass("mobile-menu-active"):t.reset()}),$(".mobile-menu-item").on("click",function(){var n=$(this).data("slug"),e=$(".page-content[data-slug="+n+"]");$("#main-content").removeClass("mobile-menu-active"),$("body").stop().animate({scrollTop:e.offset().top-t.scrollOffset},Site.scrollSpeed,"swing")})},onResize:function(){var t=this;t.setScrollOffset()},setScrollOffset:function(){var t=this;t.scrollOffset=(t.$header.outerHeight()-t.$header.height())/2+t.$header.height()},reset:function(){Site.Map.moveMap(Site.window.width*-1,Site.window.height*-1),Site.Router.resetContent(),Site.Router.cleanUrl()}},Site.Router={init:function(){var t=this;t.bind(),location.hash&&t.loadRoute(t.parseHash(location.hash))},bind:function(){var t=this;Site.$window.on("hashchange",function(){t.loadRoute(t.parseHash(location.hash))})},loadRoute:function(t){var n=this;t&&(n.resetContent(),$('.page-content[data-slug="'+t+'"]').addClass("page-content-active"),n.setMenuActive(t))},resetContent:function(){$(".page-content").removeClass("page-content-active"),$(".header-menu-active").removeClass("header-menu-active")},setMenuActive:function(t){var n=$('.header-menu-item[data-slug="'+t+'"]');$(".header-menu-active").removeClass("header-menu-active"),n.addClass("header-menu-active")},parseHash:function(t){return t.substr(3)},cleanUrl:function(){window.location.hash="",history.pushState({},"","./")}},Site.Shapes={$mapPattern:$(".map-pattern"),$patterns:[$("#pattern-1"),$("#pattern-2"),$("#pattern-3"),$("#pattern-4"),$("#pattern-5")],patternMin:0,patternMax:4,currentPattern:0,timer:null,interval:500,animating:!1,atCorner:!1,init:function(){var t=this;t.showPattern(),Site.mapElement.addEventListener("startpan",t.startAnimation.bind(t)),Site.mapElement.addEventListener("stoppan",t.stopAnimation.bind(t)),Site.mapElement.addEventListener("movemap",t.checkMapPosition.bind(t))},checkMapPosition:function(t){var n=this,e=t.detail.map.position.x,i=t.detail.map.position.y,a=0;e>=0&&a++,e<=Site.window.width*-2&&a++,i>=0&&a++,i<=Site.window.height*-2&&a++,a>=2?n.atCorner=!0:n.atCorner=!1},showPattern:function(){var t=this;t.currentPattern=Math.floor(Math.random()*(t.patternMax-t.patternMin+1))+t.patternMin,t.$patterns[t.currentPattern].addClass("show")},changePattern:function(){var t=this;t.$mapPattern.removeClass("show"),t.currentPattern>=t.patternMax?t.currentPattern=t.patternMin:t.currentPattern++,t.$patterns[t.currentPattern].addClass("show")},playAnimation:function(){var t=this;if(!t.animating)return!1;var n=(new Date).getTime(),e=n-t.startTime;e>=t.interval&&!t.atCorner&&(t.changePattern(),t.startTime=(new Date).getTime()),t.timer=window.requestAnimationFrame(t.playAnimation.bind(t))},startAnimation:function(t){var n=this;n.startTime=(new Date).getTime()-n.interval,n.animating=!0,n.playAnimation()},stopAnimation:function(){var t=this;t.animating=!1,t.atCorner=!1,window.cancelAnimationFrame(t.timer)}},Site.Map={panZoneSize:48,panSpeed:.04,panDelay:100,panning:!1,window:{},center:{},mouse:{},mapPosition:!1,pointerInHeader:!1,init:function(){var t=this;t.geolocation(),t.setPanZones(),document.addEventListener("mousemove",t.handleMouseMove.bind(t)),document.body.addEventListener("mouseleave",t.stopPanning.bind(t)),t.bindHeaderMouseOver()},onResize:function(){var t=this;t.setPanZones()},setPanZones:function(){var t=this;t.panZones={up:{min:0,max:t.panZoneSize},down:{min:Site.window.height-t.panZoneSize,max:Site.window.height},left:{min:0,max:t.panZoneSize},right:{min:Site.window.width-t.panZoneSize,max:Site.window.width}}},handleMouseMove:function(t){var n=this;n.mouse.x=t.clientX,n.mouse.y=t.clientY,n.isInsidePanZone()&&!n.panning?n.triggerPanning():n.panning&&!n.isInsidePanZone()&&n.stopPanning()},stopPanning:function(){var t=this;t.panning=!1,clearTimeout(t.delayTimeout),t.stopPanEvent()},isInsidePanZone:function(){var t=this;if(t.mouseOnHeader)return!1;var n=t.mouse.x,e=t.mouse.y;return n>=t.panZones.left.min&&n<=t.panZones.left.max||n>=t.panZones.right.min&&n<=t.panZones.right.max||e>=t.panZones.up.min&&e<=t.panZones.up.max||e>=t.panZones.down.min&&e<=t.panZones.down.max},triggerPanning:function(){var t=this;t.panning=!0,t.delayTimeout=setTimeout(function(){t.startPanEvent(),window.requestAnimationFrame(t.pan.bind(t))},t.panDelay)},startPanEvent:function(){var t=this,n=new CustomEvent("startpan",{detail:{map:{position:{x:t.mapPosition[4],y:t.mapPosition[5]}}}});Site.mapElement.dispatchEvent(n)},stopPanEvent:function(){var t=this,n=new CustomEvent("stoppan",{detail:{map:{position:{x:t.mapPosition[4],y:t.mapPosition[5]}}}});Site.mapElement.dispatchEvent(n)},pan:function(){var t=this;if(!t.panning)return!1;var n=t.angleFromCenter(),e=t.distanceFromCenter()*t.panSpeed;t.mapPosition||(t.mapPosition=t.getElemPosition(Site.mapElement));var i=t.mapPosition[4]+e*Math.cos(n),a=t.mapPosition[5]+e*Math.sin(n);t.moveMap(i,a),window.requestAnimationFrame(t.pan.bind(t))},geolocation:function(){var t=this;if(WP.clientGeolocation){if(WP.clientGeolocation.latitude&&WP.clientGeolocation.longitude){var n=Number(WP.clientGeolocation.longitude),e=Number(WP.clientGeolocation.latitude),i=n+180,a=e-90,o=i*(Site.window.width*-2)/360,r=a*(2*Site.window.height)/180;t.moveMap(o,r)}}else console.log("Geolocation not returned by the server")},moveMap:function(t,n){var e=this;t>=0&&(t=0),t<=Site.window.width*-2&&(t=Site.window.width*-2),n>=0&&(n=0),n<=Site.window.height*-2&&(n=Site.window.height*-2),e.mapPosition||(e.mapPosition=e.getElemPosition(Site.mapElement)),e.mapPosition[4]=t,e.mapPosition[5]=n,Site.mapElement.style.transform="matrix("+e.mapPosition.toString()+")",e.triggerMoveEvent(t,n)},triggerMoveEvent:function(t,n){var e=new CustomEvent("movemap",{detail:{map:{position:{x:t,y:n}}}});Site.mapElement.dispatchEvent(e)},distanceFromCenter:function(){var t=this,n=Math.pow(Site.window.center.x-t.mouse.x,2),e=Math.pow(Site.window.center.y-t.mouse.y,2),i=Math.sqrt(n+e);return i},angleFromCenter:function(){var t=Site.window.center.y-this.mouse.y,n=Site.window.center.x-this.mouse.x,e=Math.atan2(t,n);return e},getElemPosition:function(t){var n=getComputedStyle(t).transform;return(transform="none")?[1,0,0,1,0,0]:(n=n.replace(/3d|matrix|\(|\)|\s|/g,"").split(","),n=n.map(function(t){return parseInt(t,10)}))},bindHeaderMouseOver:function(){for(var t=this,n=document.querySelectorAll("#header > *"),e=0;e<n.length;e++){var i=n[e];i.addEventListener("mouseenter",t.mouseEntersHeader.bind(t)),i.addEventListener("mouseleave",t.mouseLeavesHeader.bind(t))}},mouseEntersHeader:function(){var t=this;t.mouseOnHeader=!0},mouseLeavesHeader:function(){var t=this;t.mouseOnHeader=!1}},Site.Fades={$textContent:$("#header-name, #header-menu li, #main-content"),$mapContent:$(".map-block-content"),isPanning:!1,isHoveringText:!1,init:function(){var t=this;t.handleMapPanning(),t.handleTextHover()},handleMapPanning:function(){var t=this;Site.mapElement.addEventListener("startpan",function(){t.isPanning=!0,t.$textContent.addClass("fade-element"),t.$mapContent.removeClass("fade-element")}),Site.mapElement.addEventListener("stoppan",function(){t.isPanning=!1,t.$textContent.removeClass("fade-element"),t.isHoveringText&&t.$mapContent.addClass("fade-element")})},handleTextHover:function(){var t=this;t.$textContent.hover(function(){t.isHoveringText=!0,t.isPanning||t.$mapContent.addClass("fade-element")},function(){t.isHoveringText=!1,t.$mapContent.removeClass("fade-element")})}},Site.Minimap={minimapScale:.03,indicatorPosition:!1,init:function(){var t=this;t.minimapIndicator=document.getElementById("minimap-indicator"),t.bindClick(),t.bindMapMove()},bindClick:function(){var t=this;$(".minimap-button").on("click",function(){t.handleClick(this)})},bindMapMove:function(){var t=this;Site.mapElement.addEventListener("movemap",t.moveIndicator.bind(t))},handleClick:function(t){var n=$(t).attr("data-col"),e=$(t).attr("data-row"),i=n*Site.window.width*-1,a=e*Site.window.height*-1,o=$("#map");o.addClass("slow-pan"),setTimeout(function(){o.removeClass("slow-pan")},300),Site.Map.moveMap(i,a)},moveIndicator:function(t){var n=this,e=t.detail.map.position.x,i=t.detail.map.position.y,a=e*-n.minimapScale,o=i*-n.minimapScale;n.indicatorPosition||(n.indicatorPosition=Site.Map.getElemPosition(n.minimapIndicator)),n.indicatorPosition[4]=a,n.indicatorPosition[5]=o,n.minimapIndicator.style.transform="matrix("+n.indicatorPosition.toString()+")"}},Site.Coordinates={secondsDecimalsSize:3,init:function(){var t=this;t.coordinatesHolder=document.getElementById("lat-long"),t.bindMapMove()},bindMapMove:function(){var t=this;Site.mapElement.addEventListener("movemap",t.updateCoordinates.bind(t))},updateCoordinates:function(t){var n=this,e=t.detail.map.position.x,i=t.detail.map.position.y,a=n.convertToCoordinates(e,i);n.coordinatesHolder.innerHTML=a.lat+", "+a.long},convertToCoordinates:function(t,n){var e=this,i=Site.window.width,a=Site.window.height,o=t/(i*-2)*360-180,r=n/(a*-2)*180-90;o=e.convertToDMS(o),r=e.convertToDMS(r);var s={lat:r,long:o};return s},convertToDMS:function(t){var n=this,e=Math.floor(t),i=Math.floor(60*(t-e)),a=3600*(t-e-i/60);return a=a.toFixed(n.secondsDecimalsSize),e+"° "+i+"' "+a+'"'}},Site.Orientation={init:function(){var t=this;Site.isMobileWidth&&(t.handleOrientation=t.handleOrientation.bind(t),t.bind())},bind:function(){var t=this;window.addEventListener("deviceorientation",t.handleOrientation,!0)},handleOrientation:function(t){var n=t.gamma,e=t.beta,i=(n+90)*(Site.window.width*-2)/180,a=(e+180)*(Site.window.height*-2)/360;Site.Map.moveMap(i,a)}},Site.init();
//# sourceMappingURL=main.min.js.map
