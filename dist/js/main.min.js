Site={mobileThreshold:1024,scrollSpeed:300,init:function(){var t=this;t.mapElement=document.getElementById("map"),t.$window=$(window),t.getWindowSize(),t.setIsMobileWidth(),Site.Router.init(),t.$window.resize(function(){t.onResize(),Site.Nav.onResize()}),$(document).ready(function(){Site.Shapes.init(),Site.Minimap.init(),Site.Coordinates.init(),Site.Map.init(),Site.Fades.init(),Site.Nav.init()})},getWindowSize:function(){var t=this;t.window={width:window.innerWidth,height:window.innerHeight},t.window.center={x:t.window.width/2,y:t.window.height/2}},onResize:function(){var t=this;t.getWindowSize(),t.setIsMobileWidth(),Site.Map.onResize()},setIsMobileWidth:function(){var t=this;t.window.width>=t.mobileThreshold?t.isMobileWidth=!1:t.isMobileWidth=!0},fixWidows:function(){$(".js-fix-widows").each(function(){var t=$(this).html();t=t.replace(/ ([^ ]*)$/,"&nbsp;$1"),$(this).html(t)})}},Site.Nav={init:function(){var t=this;t.$header=$("#header"),t.setScrollOffset(),t.bind()},bind:function(){var t=this;$("#header-name").on("click",function(){Site.isMobileWidth?$("#main-content").toggleClass("mobile-menu-active"):t.reset()}),$(".mobile-menu-item").on("click",function(){var e=$(this).data("slug"),n=$(".page-content[data-slug="+e+"]");$("#main-content").removeClass("mobile-menu-active"),$("body").stop().animate({scrollTop:n.offset().top-t.scrollOffset},Site.scrollSpeed,"swing")})},onResize:function(){var t=this;t.setScrollOffset()},setScrollOffset:function(){var t=this;t.scrollOffset=(t.$header.outerHeight()-t.$header.height())/2+t.$header.height()},reset:function(){Site.Map.moveMap(Site.window.width*-1,Site.window.height*-1),Site.Router.resetContent(),Site.Router.cleanUrl()}},Site.Router={init:function(){var t=this;t.bind(),location.hash&&t.loadRoute(t.parseHash(location.hash))},bind:function(){var t=this;Site.$window.on("hashchange",function(){t.loadRoute(t.parseHash(location.hash))})},loadRoute:function(t){var e=this;t&&(e.resetContent(),$('.page-content[data-slug="'+t+'"]').addClass("page-content-active"),e.setMenuActive(t))},resetContent:function(){$(".page-content").removeClass("page-content-active"),$(".header-menu-active").removeClass("header-menu-active")},setMenuActive:function(t){var e=$('.header-menu-item[data-slug="'+t+'"]');$(".header-menu-active").removeClass("header-menu-active"),e.addClass("header-menu-active")},parseHash:function(t){return t.substr(3)},cleanUrl:function(){window.location.hash="",history.pushState({},"","./")}},Site.Shapes={$mapPattern:$(".map-pattern"),$patterns:[$("#pattern-1"),$("#pattern-2"),$("#pattern-3"),$("#pattern-4"),$("#pattern-5")],patternMin:0,patternMax:4,currentPattern:0,timer:null,interval:500,animating:!1,atLimit:!1,init:function(){var t=this;t.showPattern(),Site.mapElement.addEventListener("startpan",t.startAnimation.bind(t)),Site.mapElement.addEventListener("stoppan",t.stopAnimation.bind(t)),Site.mapElement.addEventListener("movemap",t.checkMapPosition.bind(t))},checkMapPosition:function(t){var e=this,n=t.detail.map.position.x,i=t.detail.map.position.y;n>=0||n<=Site.window.width*-2||i>=0||i<=Site.window.height*-2?e.atLimit=!0:e.atLimit=!1},showPattern:function(){var t=this;t.currentPattern=Math.floor(Math.random()*(t.patternMax-t.patternMin+1))+t.patternMin,t.$patterns[t.currentPattern].addClass("show")},changePattern:function(){var t=this;t.$mapPattern.removeClass("show"),t.currentPattern>=t.patternMax?t.currentPattern=t.patternMin:t.currentPattern++,t.$patterns[t.currentPattern].addClass("show")},playAnimation:function(){var t=this;if(!t.animating||t.atLimit)return!1;var e=(new Date).getTime(),n=e-t.startTime;n>=t.interval&&(t.changePattern(),t.startTime=(new Date).getTime()),t.timer=window.requestAnimationFrame(t.playAnimation.bind(t))},startAnimation:function(t){var e=this;e.startTime=(new Date).getTime()-e.interval,e.animating=!0,e.checkMapPosition(t),e.playAnimation()},stopAnimation:function(){var t=this;t.animating=!1,t.atLimit=!1,window.cancelAnimationFrame(t.timer)}},Site.Map={panZoneSize:48,panSpeed:.04,panDelay:100,panning:!1,window:{},center:{},mouse:{},mapPosition:!1,pointerInHeader:!1,init:function(){var t=this;t.geolocation(),t.setPanZones(),document.addEventListener("mousemove",t.handleMouseMove.bind(t)),document.body.addEventListener("mouseleave",t.stopPanning.bind(t)),t.bindHeaderMouseOver()},onResize:function(){var t=this;t.setPanZones()},setPanZones:function(){var t=this;t.panZones={up:{min:0,max:t.panZoneSize},down:{min:Site.window.height-t.panZoneSize,max:Site.window.height},left:{min:0,max:t.panZoneSize},right:{min:Site.window.width-t.panZoneSize,max:Site.window.width}}},handleMouseMove:function(t){var e=this;e.mouse.x=t.clientX,e.mouse.y=t.clientY,e.isInsidePanZone()&&!e.panning?e.triggerPanning():e.panning&&!e.isInsidePanZone()&&e.stopPanning()},stopPanning:function(){var t=this;t.panning=!1,clearTimeout(t.delayTimeout),t.stopPanEvent()},isInsidePanZone:function(){var t=this;if(t.mouseOnHeader)return!1;var e=t.mouse.x,n=t.mouse.y;return e>=t.panZones.left.min&&e<=t.panZones.left.max||e>=t.panZones.right.min&&e<=t.panZones.right.max||n>=t.panZones.up.min&&n<=t.panZones.up.max||n>=t.panZones.down.min&&n<=t.panZones.down.max},triggerPanning:function(){var t=this;t.panning=!0,t.delayTimeout=setTimeout(function(){window.requestAnimationFrame(function(){t.startPanEvent(),t.pan()})},t.panDelay)},startPanEvent:function(){var t=this,e=new CustomEvent("startpan",{detail:{map:{position:{x:t.mapPosition[4],y:t.mapPosition[5]}}}});Site.mapElement.dispatchEvent(e)},stopPanEvent:function(){var t=this,e=new CustomEvent("stoppan",{detail:{map:{position:{x:t.mapPosition[4],y:t.mapPosition[5]}}}});Site.mapElement.dispatchEvent(e)},pan:function(){var t=this;if(!t.panning)return!1;var e=t.angleFromCenter(),n=t.distanceFromCenter()*t.panSpeed;t.mapPosition||(t.mapPosition=t.getElemPosition(Site.mapElement));var i=t.mapPosition[4]+n*Math.cos(e),a=t.mapPosition[5]+n*Math.sin(e);t.moveMap(i,a),window.requestAnimationFrame(t.pan.bind(t))},geolocation:function(){var t=this;if(WP.clientGeolocation){if(WP.clientGeolocation.latitude&&WP.clientGeolocation.longitude){var e=Number(WP.clientGeolocation.longitude),n=Number(WP.clientGeolocation.latitude),i=e+180,a=n-90,o=i*(Site.window.width*-2)/360,s=a*(2*Site.window.height)/180;t.moveMap(o,s)}}else console.log("Geolocation not returned by the server")},moveMap:function(t,e){var n=this;t>=0&&(t=0),t<=Site.window.width*-2&&(t=Site.window.width*-2),e>=0&&(e=0),e<=Site.window.height*-2&&(e=Site.window.height*-2),n.mapPosition||(n.mapPosition=n.getElemPosition(Site.mapElement)),n.mapPosition[4]=t,n.mapPosition[5]=e,Site.mapElement.style.transform="matrix("+n.mapPosition.toString()+")",n.triggerMoveEvent(t,e)},triggerMoveEvent:function(t,e){var n=new CustomEvent("movemap",{detail:{map:{position:{x:t,y:e}}}});Site.mapElement.dispatchEvent(n)},distanceFromCenter:function(){var t=this,e=Math.pow(Site.window.center.x-t.mouse.x,2),n=Math.pow(Site.window.center.y-t.mouse.y,2),i=Math.sqrt(e+n);return i},angleFromCenter:function(){var t=Site.window.center.y-this.mouse.y,e=Site.window.center.x-this.mouse.x,n=Math.atan2(t,e);return n},getElemPosition:function(t){var e=getComputedStyle(t).transform;return e=e.replace(/3d|matrix|\(|\)|\s|/g,"").split(","),e=e.map(function(t){return parseInt(t,10)})},bindHeaderMouseOver:function(){for(var t=this,e=document.querySelectorAll("#header > *"),n=0;n<e.length;n++){var i=e[n];i.addEventListener("mouseenter",t.mouseEntersHeader.bind(t)),i.addEventListener("mouseleave",t.mouseLeavesHeader.bind(t))}},mouseEntersHeader:function(){var t=this;t.mouseOnHeader=!0},mouseLeavesHeader:function(){var t=this;t.mouseOnHeader=!1}},Site.Fades={$textContent:$("#header-name, #header-menu li, #main-content"),$mapContent:$(".map-block-content"),isPanning:!1,isHoveringText:!1,init:function(){var t=this;t.handleMapPanning(),t.handleTextHover()},handleMapPanning:function(){var t=this;Site.mapElement.addEventListener("startpan",function(){t.isPanning=!0,t.$textContent.addClass("fade-element"),t.$mapContent.removeClass("fade-element")}),Site.mapElement.addEventListener("stoppan",function(){t.isPanning=!1,t.$textContent.removeClass("fade-element"),t.isHoveringText&&t.$mapContent.addClass("fade-element")})},handleTextHover:function(){var t=this;t.$textContent.hover(function(){t.isHoveringText=!0,t.isPanning||t.$mapContent.addClass("fade-element")},function(){t.isHoveringText=!1,t.$mapContent.removeClass("fade-element")})}},Site.Minimap={minimapScale:.03,indicatorPosition:!1,init:function(){var t=this;t.minimapIndicator=document.getElementById("minimap-indicator"),t.bindClick(),t.bindMapMove()},bindClick:function(){var t=this;$(".minimap-button").on("click",function(){t.handleClick(this)})},bindMapMove:function(){var t=this;Site.mapElement.addEventListener("movemap",t.moveIndicator.bind(t))},handleClick:function(t){var e=$(t).attr("data-col"),n=$(t).attr("data-row"),i=e*Site.window.width*-1,a=n*Site.window.height*-1,o=$("#map");o.addClass("slow-pan"),setTimeout(function(){o.removeClass("slow-pan")},300),Site.Map.moveMap(i,a)},moveIndicator:function(t){var e=this,n=t.detail.map.position.x,i=t.detail.map.position.y,a=n*-e.minimapScale,o=i*-e.minimapScale;e.indicatorPosition||(e.indicatorPosition=Site.Map.getElemPosition(e.minimapIndicator)),e.indicatorPosition[4]=a,e.indicatorPosition[5]=o,e.minimapIndicator.style.transform="matrix("+e.indicatorPosition.toString()+")"}},Site.Coordinates={secondsDecimalsSize:3,init:function(){var t=this;t.coordinatesHolder=document.getElementById("lat-long"),t.bindMapMove()},bindMapMove:function(){var t=this;Site.mapElement.addEventListener("movemap",t.updateCoordinates.bind(t))},updateCoordinates:function(t){var e=this,n=t.detail.map.position.x,i=t.detail.map.position.y,a=e.convertToCoordinates(n,i);e.coordinatesHolder.innerHTML=a.lat+", "+a.long},convertToCoordinates:function(t,e){var n=this,i=Site.window.width,a=Site.window.height,o=t/(i*-2)*360-180,s=e/(a*-2)*180-90;o=n.convertToDMS(o),s=n.convertToDMS(s);var r={lat:s,long:o};return r},convertToDMS:function(t){var e=this,n=Math.floor(t),i=Math.floor(60*(t-n)),a=3600*(t-n-i/60);return a=a.toFixed(e.secondsDecimalsSize),n+"° "+i+"' "+a+'"'}},Site.init();
//# sourceMappingURL=main.min.js.map
