{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","init","_this","this","Menu","Router","$","window","resize","onResize","document","ready","Shapes","Map","fixWidows","each","string","html","replace","$headerItems","setMenuActive","hash","$item","removeClass","addClass","bind","location","loadRoute","parseHash","on","rawHash","substr","currentState","maxState","timer","interval","setState","startInterval","setInterval","nextState","panZoneSize","panSpeed","panning","center","mouse","mapPosition","getWindowSize","map","getElementById","setPanZones","addEventListener","handleMouseMove","body","stopPanning","width","innerWidth","height","innerHeight","x","y","panZones","up","min","max","down","left","right","event","clientX","clientY","isInsidePanZone","triggerPanning","stopPanEvent","posX","posY","startPanEvent","requestAnimationFrame","pan","CustomEvent","detail","position","dispatchEvent","angle","angleFromCenter","translation","distanceFromCenter","getMapPosition","newX","Math","cos","newY","sin","moveMap","style","transform","toString","xs","pow","ys","distance","sqrt","dy","dx","theta","atan2","transformMatrix","getComputedStyle","split","item","parseInt"],"mappings":"AAGAA,MACEC,gBAAiB,IACjBC,KAAM,WACJ,GAAIC,GAAQC,IAEZJ,MAAKK,KAAKH,OACVF,KAAKM,OAAOJ,OAEZK,EAAEC,QAAQC,OAAO,WACfN,EAAMO,aAGRH,EAAEI,UAAUC,MAAM,WAChBZ,KAAKa,OAAOX,OACZF,KAAKc,IAAIZ,UAKbQ,SAAU,aAKVK,UAAW,WAETR,EAAE,kBAAkBS,KAAK,WACvB,GAAIC,GAASV,EAAEH,MAAMc,MACrBD,GAASA,EAAOE,QAAQ,YAAY,YACpCZ,EAAEH,MAAMc,KAAKD,OAKnBjB,KAAKK,MACHe,aAAcb,EAAE,qBAEhBL,KAAM,aAINmB,cAAe,SAASC,GACtB,GACIC,GAAQhB,EAAE,gCAAkCe,EAAO,KAEvDf,GAAE,uBAAuBiB,YAAY,sBACrCD,EAAME,SAAS,wBAInBzB,KAAKM,QACHJ,KAAM,WACJ,GAAIC,GAAQC,IAEZD,GAAMuB,OAEFC,SAASL,MACXnB,EAAMyB,UAAUzB,EAAM0B,UAAUF,SAASL,QAI7CI,KAAM,WACJ,GAAIvB,GAAQC,IAEZG,GAAEC,QAAQsB,GAAG,aAAc,WACzB3B,EAAMyB,UAAUzB,EAAM0B,UAAUF,SAASL,UAK7CM,UAAW,SAASN,GAGdA,IACFf,EAAE,iBAAiBiB,YAAY,uBAC/BjB,EAAE,4BAA8Be,EAAO,MAAMG,SAAS,uBAEtDzB,KAAKK,KAAKgB,cAAcC,KAI5BO,UAAW,SAASE,GAClB,MAAOA,GAAQC,OAAO,KAI1BhC,KAAKa,QACHoB,aAAc,EACdC,SAAU,EACVC,MAAO,KACPC,SAAU,KACVlC,KAAM,WACJ,GAAIC,GAAQC,IAEZD,GAAMkC,WACNlC,EAAMmC,iBAGRA,cAAe,WACb,GAAInC,GAAQC,IAEZD,GAAMgC,MAAQI,YAAY,WAAYpC,EAAMkC,YAAclC,EAAMiC,WAGlEI,UAAW,WACT,GAAIrC,GAAQC,IAQZ,OANAD,GAAM8B,eAEF9B,EAAM8B,aAAe9B,EAAM+B,WAC7B/B,EAAM8B,aAAe,GAGhB9B,EAAM8B,cAGfI,SAAU,WACR,GAAIlC,GAAQC,IAEZG,GAAE,qBACDiB,YAAY,eAAiBrB,EAAM8B,cACnCR,SAAS,eAAiBtB,EAAMqC,eAIrCxC,KAAKc,KACH2B,YAAa,IACbC,SAAU,IACVC,SAAS,EACTnC,UACAoC,UACAC,SACAC,aAAa,EAEb5C,KAAM,WACJ,GAAIC,GAASC,IAGbD,GAAM4C,gBAGN5C,EAAM6C,IAAMrC,SAASsC,eAAe,OAGpC9C,EAAM+C,cAGNvC,SAASwC,iBAAiB,YAAahD,EAAMiD,gBAAgB1B,KAAKvB,IAGlEQ,SAAS0C,KAAKF,iBAAiB,aAAchD,EAAMmD,YAAY5B,KAAKvB,KAGtE4C,cAAe,WACb,GAAI5C,GAASC,IAGbD,GAAMK,QACJ+C,MAAO/C,OAAOgD,WACdC,OAAQjD,OAAOkD,aAIjBvD,EAAMK,OAAOoC,QACXe,EAAGxD,EAAMK,OAAO+C,MAAQ,EACxBK,EAAGzD,EAAMK,OAAOiD,OAAS,IAM7BP,YAAa,WACX,GAAI/C,GAASC,IAEbD,GAAM0D,UACJC,IACEC,IAAK,EACLC,IAAK7D,EAAMsC,aAEbwB,MACEF,IAAK5D,EAAMK,OAAOiD,OAAStD,EAAMsC,YACjCuB,IAAK7D,EAAMK,OAAOiD,QAEpBS,MACEH,IAAK,EACLC,IAAK7D,EAAMsC,aAEb0B,OACEJ,IAAK5D,EAAMK,OAAO+C,MAAQpD,EAAMsC,YAChCuB,IAAK7D,EAAMK,OAAO+C,SAMxBH,gBAAiB,SAASgB,GACxB,GAAIjE,GAASC,IAGbD,GAAM0C,MAAMc,EAAIS,EAAMC,QACtBlE,EAAM0C,MAAMe,EAAIQ,EAAME,QAGnBnE,EAAMoE,oBAAsBpE,EAAMwC,QACnCxC,EAAMqE,iBACErE,EAAMwC,UAAYxC,EAAMoE,mBAChCpE,EAAMmD,eAKVA,YAAa,WACX,GAAInD,GAASC,IAEbD,GAAMwC,SAAU,EAEhBxC,EAAMsE,gBAKRF,gBAAiB,WACf,GAAIpE,GAASC,KAETsE,EAAOvE,EAAM0C,MAAMc,EACnBgB,EAAOxE,EAAM0C,MAAMe,CAEvB,OAAMc,IAAQvE,EAAM0D,SAASK,KAAKH,KAAOW,GAAQvE,EAAM0D,SAASK,KAAKF,KAClEU,GAAQvE,EAAM0D,SAASM,MAAMJ,KAAOW,GAAQvE,EAAM0D,SAASM,MAAMH,KACjEW,GAAQxE,EAAM0D,SAASC,GAAGC,KAAOY,GAAQxE,EAAM0D,SAASC,GAAGE,KAC3DW,GAAQxE,EAAM0D,SAASI,KAAKF,KAAOY,GAAQxE,EAAM0D,SAASI,KAAKD,KAUpEQ,eAAgB,WACd,GAAIrE,GAASC,IAEbD,GAAMwC,SAAU,EAEhBxC,EAAMyE,gBAENpE,OAAOqE,sBAAsB1E,EAAM2E,IAAIpD,KAAKvB,KAI9CyE,cAAe,WACb,GAAIzE,GAASC,KAETwE,EAAgB,GAAIG,aAAY,YAClCC,QACEhC,KACEiC,UACEtB,EAAGxD,EAAM2C,YAAY,GACrBc,EAAGzD,EAAM2C,YAAY,OAM7B3C,GAAM6C,IAAIkC,cAAcN,IAI1BH,aAAc,WACZ,GAAItE,GAASC,KAETqE,EAAe,GAAIM,aAAY,WACjCC,QACEhC,KACEiC,UACEtB,EAAGxD,EAAM2C,YAAY,GACrBc,EAAGzD,EAAM2C,YAAY,OAM7B3C,GAAM6C,IAAIkC,cAAcT,IAK1BK,IAAK,WACH,GAAI3E,GAASC,IAGb,KAAKD,EAAMwC,QACT,OAAO,CAIT,IAAIwC,GAAQhF,EAAMiF,kBAGdC,EAAclF,EAAMmF,qBAAuBnF,EAAMuC,QAGhDvC,GAAM2C,cACT3C,EAAM2C,YAAc3C,EAAMoF,iBAI5B,IAAIC,GAAOrF,EAAM2C,YAAY,GAAMuC,EAAcI,KAAKC,IAAIP,GACtDQ,EAAOxF,EAAM2C,YAAY,GAAMuC,EAAcI,KAAKG,IAAIT,EAGtDK,IAAQ,IACVA,EAAO,GAILA,GAAQrF,EAAMK,OAAO+C,OAAQ,IAC/BiC,EAAOrF,EAAMK,OAAO+C,OAAQ,GAI1BoC,GAAQ,IACVA,EAAO,GAILA,GAAQxF,EAAMK,OAAOiD,QAAS,IAChCkC,EAAOxF,EAAMK,OAAOiD,QAAS,GAI/BtD,EAAM0F,QAAQL,EAAKG,GAGnBnF,OAAOqE,sBAAsB1E,EAAM2E,IAAIpD,KAAKvB,KAK9C0F,QAAS,SAASlC,EAAEC,GAClB,GAAIzD,GAASC,IAGRD,GAAM2C,cACT3C,EAAM2C,YAAc3C,EAAMoF,kBAI5BpF,EAAM2C,YAAY,GAAKa,EACvBxD,EAAM2C,YAAY,GAAKc,EAGvBzD,EAAM6C,IAAI8C,MAAMC,UAAY,UAAY5F,EAAM2C,YAAYkD,WAAa,KAKzEV,mBAAoB,WAClB,GAAInF,GAAQC,KAER6F,EAAKR,KAAKS,IAAI/F,EAAMK,OAAOoC,OAAOe,EAAIxD,EAAM0C,MAAMc,EAAG,GACrDwC,EAAKV,KAAKS,IAAI/F,EAAMK,OAAOoC,OAAOgB,EAAIzD,EAAM0C,MAAMe,EAAG,GACrDwC,EAAWX,KAAKY,KAAKJ,EAAKE,EAE9B,OAAOC,IAIThB,gBAAiB,WACf,GAAIjF,GAAQC,KAERkG,EAAKnG,EAAMK,OAAOoC,OAAOgB,EAAIxD,KAAKyC,MAAMe,EACxC2C,EAAKpG,EAAMK,OAAOoC,OAAOe,EAAIvD,KAAKyC,MAAMc,EAExC6C,EAAQf,KAAKgB,MAAMH,EAAIC,EAE3B,OAAOC,IAITjB,eAAgB,WACd,GAGImB,GAAkBC,iBAAiBvG,KAAK4C,KAAgB,SAM5D,OAHA0D,GAAkBA,EAAgBvF,QAAQ,UAAU,IAAIA,QAAQ,IAAK,IAG9DuF,EAAkBA,EAAgBE,MAAM,MAAM5D,IAAK,SAAS6D,GACjE,MAAOC,UAASD,EAAM,QAK5B7G,KAAKE","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, jQuery, document, Site, Modernizr */\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    Site.Menu.init();\n    Site.Router.init();\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n      Site.Shapes.init();\n      Site.Map.init();\n    });\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n};\n\nSite.Menu = {\n  $headerItems: $('.header-menu-item'),\n\n  init: function() {\n    var _this = this;\n  },\n\n  setMenuActive: function(hash) {\n    var _this = this;\n    var $item = $('.header-menu-item[data-slug=\"' + hash + '\"]')\n\n    $('.header-menu-active').removeClass('header-menu-active');\n    $item.addClass('header-menu-active');\n  }\n};\n\nSite.Router = {\n  init: function() {\n    var _this = this;\n\n    _this.bind();\n\n    if (location.hash) {\n      _this.loadRoute(_this.parseHash(location.hash));\n    }\n  },\n\n  bind: function() {\n    var _this = this;\n\n    $(window).on('hashchange', function() {\n      _this.loadRoute(_this.parseHash(location.hash));\n    });\n\n  },\n\n  loadRoute: function(hash) {\n    var _this = this;\n\n    if (hash) {\n      $('.page-content').removeClass('page-content-active');\n      $('.page-content[data-slug=\"' + hash + '\"]').addClass('page-content-active');\n\n      Site.Menu.setMenuActive(hash);\n    }\n  },\n\n  parseHash: function(rawHash) {\n    return rawHash.substr(3);\n  },\n};\n\nSite.Shapes = {\n  currentState: 0,\n  maxState: 7,\n  timer: null,\n  interval: 12000,\n  init: function() {\n    var _this = this;\n\n    _this.setState();\n    _this.startInterval();\n  },\n\n  startInterval: function() {\n    var _this = this;\n\n    _this.timer = setInterval(function() {_this.setState();}, _this.interval);\n  },\n\n  nextState: function() {\n    var _this = this;\n\n    _this.currentState++;\n\n    if (_this.currentState > _this.maxState) {\n      _this.currentState = 1;\n    }\n\n    return _this.currentState;\n  },\n\n  setState: function() {\n    var _this = this;\n\n    $('#background-shape')\n    .removeClass('shape-state-' + _this.currentState)\n    .addClass('shape-state-' + _this.nextState());\n  },\n};\n\nSite.Map = {\n  panZoneSize: 100, // in pixels\n  panSpeed: 0.04,\n  panning: false, // is it panning or not?\n  window: {},\n  center: {},\n  mouse: {},\n  mapPosition: false,\n\n  init: function() {\n    var _this =  this;\n\n    // Set windowSize\n    _this.getWindowSize();\n\n    // Set map element\n    _this.map = document.getElementById('map');\n\n    // init pan zones\n    _this.setPanZones();\n\n    // Bind mouse position\n    document.addEventListener('mousemove', _this.handleMouseMove.bind(_this));\n\n    // Detect mouse outside window\n    document.body.addEventListener('mouseleave', _this.stopPanning.bind(_this));\n  },\n\n  getWindowSize: function() {\n    var _this =  this;\n\n    // Save window size\n    _this.window = {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    };\n\n    // Save window center\n    _this.window.center = {\n      x: _this.window.width / 2,\n      y: _this.window.height / 2,\n    };\n\n  },\n\n  // Set Up, Left, Down and Right pan zones based on window size\n  setPanZones: function() {\n    var _this =  this;\n\n    _this.panZones = {\n      up: {\n        min: 0,\n        max: _this.panZoneSize,\n      },\n      down: {\n        min: _this.window.height - _this.panZoneSize,\n        max: _this.window.height,\n      },\n      left: {\n        min: 0,\n        max: _this.panZoneSize,\n      },\n      right: {\n        min: _this.window.width - _this.panZoneSize,\n        max: _this.window.width,\n      },\n    };\n\n  },\n\n  handleMouseMove: function(event) {\n    var _this =  this;\n\n    // Save mouse position\n    _this.mouse.x = event.clientX;\n    _this.mouse.y = event.clientY;\n\n\n    if(_this.isInsidePanZone() && !_this.panning) {\n      _this.triggerPanning(); // Trigger animation\n    } else if(_this.panning && !_this.isInsidePanZone()) {\n      _this.stopPanning(); // Stop animation\n    }\n\n  },\n\n  stopPanning: function() {\n    var _this =  this;\n\n    _this.panning = false;\n\n    _this.stopPanEvent();\n\n  },\n\n  // (Bool) check if mouse is inside any pan zone\n  isInsidePanZone: function() {\n    var _this =  this;\n\n    var posX = _this.mouse.x;\n    var posY = _this.mouse.y;\n\n    if ( (posX >= _this.panZones.left.min && posX <= _this.panZones.left.max) || // Left\n      (posX >= _this.panZones.right.min && posX <= _this.panZones.right.max) || // Right\n      (posY >= _this.panZones.up.min && posY <= _this.panZones.up.max) || // Up\n      (posY >= _this.panZones.down.min && posY <= _this.panZones.down.max) ) { //  Down\n\n        return true;\n      }\n\n    return false;\n\n  },\n\n  // Trigger panning animation\n  triggerPanning: function() {\n    var _this =  this;\n\n    _this.panning = true;\n\n    _this.startPanEvent();\n\n    window.requestAnimationFrame(_this.pan.bind(_this));\n\n  },\n\n  startPanEvent: function() {\n    var _this =  this;\n\n    var startPanEvent = new CustomEvent('startpan', {\n      detail: {\n        map: {\n          position: {\n            x: _this.mapPosition[4],\n            y: _this.mapPosition[5],\n          },\n        },\n      },\n    });\n\n    _this.map.dispatchEvent(startPanEvent);\n\n  },\n\n  stopPanEvent: function() {\n    var _this =  this;\n\n    var stopPanEvent = new CustomEvent('stoppan', {\n      detail: {\n        map: {\n          position: {\n            x: _this.mapPosition[4],\n            y: _this.mapPosition[5],\n          },\n        },\n      },\n    });\n\n    _this.map.dispatchEvent(stopPanEvent);\n\n  },\n\n  // Main panning logic\n  pan: function() {\n    var _this =  this;\n\n    // Check is panning has been stopped; we do this here to fail faster\n    if (!_this.panning) {\n      return false;\n    }\n\n    // Get the angle between center and mouse position\n    var angle = _this.angleFromCenter();\n\n    // Get the translation value based on mouse position from the center and speed\n    var translation = _this.distanceFromCenter() * _this.panSpeed;\n\n    // If we don't know the map's current postion we get it\n    if (!_this.mapPosition) {\n      _this.mapPosition = _this.getMapPosition();\n    }\n\n    // Get new coordinates based on the angle and the translation value\n    var newX = _this.mapPosition[4] + (translation * Math.cos(angle));\n    var newY = _this.mapPosition[5] + (translation * Math.sin(angle));\n\n    // Check for left limit\n    if (newX >= 0) {\n      newX = 0;\n    }\n\n    // Check for right limit\n    if (newX <= _this.window.width * -2) {\n      newX = _this.window.width * -2;\n    }\n\n    // Check for upper limit\n    if (newY >= 0) {\n      newY = 0;\n    }\n\n    // Check for bottom limit\n    if (newY <= _this.window.height * -2) {\n      newY = _this.window.height * -2;\n    }\n\n    // Move the map\n    _this.moveMap(newX,newY);\n\n    // Animate recursevly\n    window.requestAnimationFrame(_this.pan.bind(_this));\n\n  },\n\n  // Move the map to given coordinates\n  moveMap: function(x,y) {\n    var _this =  this;\n\n    // If we don't know the map's current postion we get it\n    if (!_this.mapPosition) {\n      _this.mapPosition = _this.getMapPosition();\n    }\n\n    // Set new coordinates\n    _this.mapPosition[4] = x;\n    _this.mapPosition[5] = y;\n\n    // Apply new coordinates\n    _this.map.style.transform = 'matrix(' + _this.mapPosition.toString() + ')';\n\n  },\n\n  // Return distance between center and mouse positon in pixels\n  distanceFromCenter: function() {\n    var _this = this;\n\n    var xs = Math.pow(_this.window.center.x - _this.mouse.x, 2);\n    var ys = Math.pow(_this.window.center.y - _this.mouse.y, 2);\n    var distance = Math.sqrt(xs + ys);\n\n    return distance;\n  },\n\n  // Return angle in rad from center of the window and mouse position relative to X-axis\n  angleFromCenter: function() {\n    var _this = this;\n\n    var dy = _this.window.center.y - this.mouse.y;\n    var dx = _this.window.center.x - this.mouse.x;\n\n    var theta = Math.atan2(dy, dx); // range (-PI, PI]\n\n    return theta;\n  },\n\n  // Return current map postion\n  getMapPosition: function() {\n    var _this =  this;\n\n    // Get current element position (transform values)\n    var transformMatrix = getComputedStyle(this.map)['transform']; // Returns a string like \"matrix(0,0,0,0,0,0)\"\n\n    // Get only the values\n    transformMatrix = transformMatrix.replace('matrix(','').replace(')', ''); // Returns a string like \"0,0,0,0,0,0\"\n\n    // Make it into an array\n    return transformMatrix = transformMatrix.split(', ').map( function(item) {\n      return parseInt(item, 10);\n    }); // Returns an array like [0,0,0,0,0,0]\n  }\n};\n\nSite.init();\n"]}