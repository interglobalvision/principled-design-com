{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","init","_this","this","Menu","$","window","resize","onResize","document","ready","Shapes","Map","fixWidows","each","string","html","replace","$headerItems","bind","on","e","onItemClick","item","event","href","children","attr","hash","substr","removeClass","addClass","$mapPattern","$patterns","patternMin","patternMax","currentPattern","timer","interval","animating","showPattern","map","getElementById","addEventListener","startAnimation","stopAnimation","patternStyle","parseInt","Math","random","floor","changePattern","requestAnimationFrame","panZoneSize","panSpeed","panning","center","mouse","mapPosition","getWindowSize","setPanZones","handleMouseMove","body","stopPanning","width","innerWidth","height","innerHeight","x","y","panZones","up","min","max","down","left","right","clientX","clientY","isInsidePanZone","triggerPanning","stopPanEvent","posX","posY","startPanEvent","pan","CustomEvent","detail","position","dispatchEvent","angle","angleFromCenter","translation","distanceFromCenter","getMapPosition","newX","cos","newY","sin","moveMap","style","transform","toString","xs","pow","ys","distance","sqrt","dy","dx","theta","atan2","transformMatrix","getComputedStyle","split"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, jQuery, document, Site, Modernizr */\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    Site.Menu.init();\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n      Site.Shapes.init();\n      Site.Map.init();\n    });\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n};\n\nSite.Menu = {\n  $headerItems: $('.header-menu-item'),\n  init: function() {\n    var _this = this;\n\n    _this.bind();\n  },\n\n  bind: function() {\n    var _this = this;\n\n    _this.$headerItems.on('click', function(e) {\n      _this.onItemClick(this, e);\n    });\n  },\n\n  onItemClick: function(item, event) {\n    var _this = this;\n    var href = $(item).children('a').attr('href');\n    var hash = href.substr(1);\n\n    $('.header-menu-active').removeClass('header-menu-active');\n    $(item).addClass('header-menu-active');\n\n    $('.page-content').removeClass('page-content-active');\n    $('.page-content[data-slug=\"' + hash + '\"]').addClass('page-content-active');\n  },\n};\n\nSite.Shapes = {\n  $mapPattern: $('.map-pattern'),\n  $patterns: [\n    $('#pattern-1'),\n    $('#pattern-2'),\n    $('#pattern-3'),\n    $('#pattern-4'),\n    $('#pattern-5'),\n  ],\n  patternMin: 0,\n  patternMax: 4,\n  currentPattern: 0,\n  timer: null,\n  interval: 100,\n  animating: false,\n\n  init: function() {\n    var _this = this;\n\n    _this.showPattern();\n\n    var map = document.getElementById('map');\n\n    map.addEventListener('startpan', function() {\n      _this.startAnimation();\n    });\n\n    map.addEventListener('stoppan', function() {\n      _this.stopAnimation();\n    });\n\n  },\n\n  showPattern: function() {\n    var _this = this;\n\n    // Choose 1 or 0\n    var patternStyle = parseInt(Math.random() * 2);\n\n    if (patternStyle === 1) {\n      // If 1, fill paths\n      $('#background-pattern-holder').addClass('fill-path');\n    } else {\n      // If 0, stroke paths\n      $('#background-pattern-holder').addClass('stroke-path');\n    }\n\n    // Assign random current pattern array index\n    _this.currentPattern = Math.floor(Math.random() * (_this.patternMax - _this.patternMin + 1)) + _this.patternMin;\n\n    // Show current pattern\n    _this.$patterns[_this.currentPattern].addClass('show');\n  },\n\n  changePattern: function() {\n    var _this = this;\n\n    // Check is animating has been stopped; we do this here to fail faster\n    if (!_this.animating) {\n      return false;\n    }\n\n    // Hide current pattern\n    _this.$mapPattern.removeClass('show');\n\n    // Assign next current pattern\n    if (_this.currentPattern >= _this.patternMax) {\n      // If last pattern, start from min index\n      _this.currentPattern = _this.patternMin;\n    } else {\n      // Else, assign next index\n      _this.currentPattern++;\n    }\n\n    // Show new current pattern\n    _this.$patterns[_this.currentPattern].addClass('show');\n\n    // Animate recursively\n    window.requestAnimationFrame(_this.changePattern.bind(_this));\n  },\n\n  startAnimation: function() {\n    var _this = this;\n\n    _this.animating = true;\n\n    window.requestAnimationFrame(_this.changePattern.bind(_this));\n  },\n\n  stopAnimation: function() {\n    var _this = this;\n\n    _this.animating = false;\n  },\n};\n\nSite.Map = {\n  panZoneSize: 100, // in pixels\n  panSpeed: 0.04,\n  panning: false, // is it panning or not?\n  window: {},\n  center: {},\n  mouse: {},\n  mapPosition: false,\n\n  init: function() {\n    var _this =  this;\n\n    // Set windowSize\n    _this.getWindowSize();\n\n    // Set map element\n    _this.map = document.getElementById('map');\n\n    // init pan zones\n    _this.setPanZones();\n\n    // Bind mouse position\n    document.addEventListener('mousemove', _this.handleMouseMove.bind(_this));\n\n    // Detect mouse outside window\n    document.body.addEventListener('mouseleave', _this.stopPanning.bind(_this));\n  },\n\n  getWindowSize: function() {\n    var _this =  this;\n\n    // Save window size\n    _this.window = {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    };\n\n    // Save window center\n    _this.window.center = {\n      x: _this.window.width / 2,\n      y: _this.window.height / 2,\n    };\n\n  },\n\n  // Set Up, Left, Down and Right pan zones based on window size\n  setPanZones: function() {\n    var _this =  this;\n\n    _this.panZones = {\n      up: {\n        min: 0,\n        max: _this.panZoneSize,\n      },\n      down: {\n        min: _this.window.height - _this.panZoneSize,\n        max: _this.window.height,\n      },\n      left: {\n        min: 0,\n        max: _this.panZoneSize,\n      },\n      right: {\n        min: _this.window.width - _this.panZoneSize,\n        max: _this.window.width,\n      },\n    };\n\n  },\n\n  handleMouseMove: function(event) {\n    var _this =  this;\n\n    // Save mouse position\n    _this.mouse.x = event.clientX;\n    _this.mouse.y = event.clientY;\n\n\n    if(_this.isInsidePanZone() && !_this.panning) {\n      _this.triggerPanning(); // Trigger animation\n    } else if(_this.panning && !_this.isInsidePanZone()) {\n      _this.stopPanning(); // Stop animation\n    }\n\n  },\n\n  stopPanning: function() {\n    var _this =  this;\n\n    _this.panning = false;\n\n    _this.stopPanEvent();\n\n  },\n\n  // (Bool) check if mouse is inside any pan zone\n  isInsidePanZone: function() {\n    var _this =  this;\n\n    var posX = _this.mouse.x;\n    var posY = _this.mouse.y;\n\n    if ( (posX >= _this.panZones.left.min && posX <= _this.panZones.left.max) || // Left\n      (posX >= _this.panZones.right.min && posX <= _this.panZones.right.max) || // Right\n      (posY >= _this.panZones.up.min && posY <= _this.panZones.up.max) || // Up\n      (posY >= _this.panZones.down.min && posY <= _this.panZones.down.max) ) { //  Down\n\n        return true;\n      }\n\n    return false;\n\n  },\n\n  // Trigger panning animation\n  triggerPanning: function() {\n    var _this =  this;\n\n    _this.panning = true;\n\n    _this.startPanEvent();\n\n    window.requestAnimationFrame(_this.pan.bind(_this));\n\n  },\n\n  startPanEvent: function() {\n    var _this =  this;\n\n    var startPanEvent = new CustomEvent('startpan', {\n      detail: {\n        map: {\n          position: {\n            x: _this.mapPosition[4],\n            y: _this.mapPosition[5],\n          },\n        },\n      },\n    });\n\n    _this.map.dispatchEvent(startPanEvent);\n\n  },\n\n  stopPanEvent: function() {\n    var _this =  this;\n\n    var stopPanEvent = new CustomEvent('stoppan', {\n      detail: {\n        map: {\n          position: {\n            x: _this.mapPosition[4],\n            y: _this.mapPosition[5],\n          },\n        },\n      },\n    });\n\n    _this.map.dispatchEvent(stopPanEvent);\n\n  },\n\n  // Main panning logic\n  pan: function() {\n    var _this =  this;\n\n    // Check is panning has been stopped; we do this here to fail faster\n    if (!_this.panning) {\n      return false;\n    }\n\n    // Get the angle between center and mouse position\n    var angle = _this.angleFromCenter();\n\n    // Get the translation value based on mouse position from the center and speed\n    var translation = _this.distanceFromCenter() * _this.panSpeed;\n\n    // If we don't know the map's current postion we get it\n    if (!_this.mapPosition) {\n      _this.mapPosition = _this.getMapPosition();\n    }\n\n    // Get new coordinates based on the angle and the translation value\n    var newX = _this.mapPosition[4] + (translation * Math.cos(angle));\n    var newY = _this.mapPosition[5] + (translation * Math.sin(angle));\n\n    // Check for left limit\n    if (newX >= 0) {\n      newX = 0;\n    }\n\n    // Check for right limit\n    if (newX <= _this.window.width * -2) {\n      newX = _this.window.width * -2;\n    }\n\n    // Check for upper limit\n    if (newY >= 0) {\n      newY = 0;\n    }\n\n    // Check for bottom limit\n    if (newY <= _this.window.height * -2) {\n      newY = _this.window.height * -2;\n    }\n\n    // Move the map\n    _this.moveMap(newX,newY);\n\n    // Animate recursevly\n    window.requestAnimationFrame(_this.pan.bind(_this));\n\n  },\n\n  // Move the map to given coordinates\n  moveMap: function(x,y) {\n    var _this =  this;\n\n    // If we don't know the map's current postion we get it\n    if (!_this.mapPosition) {\n      _this.mapPosition = _this.getMapPosition();\n    }\n\n    // Set new coordinates\n    _this.mapPosition[4] = x;\n    _this.mapPosition[5] = y;\n\n    // Apply new coordinates\n    _this.map.style.transform = 'matrix(' + _this.mapPosition.toString() + ')';\n\n  },\n\n  // Return distance between center and mouse positon in pixels\n  distanceFromCenter: function() {\n    var _this = this;\n\n    var xs = Math.pow(_this.window.center.x - _this.mouse.x, 2);\n    var ys = Math.pow(_this.window.center.y - _this.mouse.y, 2);\n    var distance = Math.sqrt(xs + ys);\n\n    return distance;\n  },\n\n  // Return angle in rad from center of the window and mouse position relative to X-axis\n  angleFromCenter: function() {\n    var _this = this;\n\n    var dy = _this.window.center.y - this.mouse.y;\n    var dx = _this.window.center.x - this.mouse.x;\n\n    var theta = Math.atan2(dy, dx); // range (-PI, PI]\n\n    return theta;\n  },\n\n  // Return current map postion\n  getMapPosition: function() {\n    var _this =  this;\n\n    // Get current element position (transform values)\n    var transformMatrix = getComputedStyle(this.map)['transform']; // Returns a string like \"matrix(0,0,0,0,0,0)\"\n\n    // Get only the values\n    transformMatrix = transformMatrix.replace('matrix(','').replace(')', ''); // Returns a string like \"0,0,0,0,0,0\"\n\n    // Make it into an array\n    return transformMatrix = transformMatrix.split(', ').map( function(item) {\n      return parseInt(item, 10);\n    }); // Returns an array like [0,0,0,0,0,0]\n  }\n};\n\nSite.init();\n"]}