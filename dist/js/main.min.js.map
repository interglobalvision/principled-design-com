{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","init","_this","this","Menu","$","window","resize","onResize","document","ready","Shapes","Map","fixWidows","each","string","html","replace","$headerItems","bind","on","e","onItemClick","item","event","removeClass","addClass","currentState","maxState","timer","interval","setState","startInterval","setInterval","nextState","panZoneSize","distanceThreshold","thresholdRadious","panning","pan","up","down","left","right","width","height","mouse","x","y","center","mapPosition","getWindowSize","map","getElementById","setPanZones","addEventListener","handleMouseMove","body","noPan","innerWidth","innerHeight","clientX","clientY","triggerAnimation","requestAnimationFrame","animate","distanceFromCenter","angle","angleFromCenter","distance","getMapPosition","Math","cos","sin","style","transform","toString","xs","pow","ys","sqrt","dy","dx","theta","atan2","PI","transformMatrix","getComputedStyle","split","parseInt"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, jQuery, document, Site, Modernizr */\n\nSite = {\n  mobileThreshold: 601,\n  init: function() {\n    var _this = this;\n\n    Site.Menu.init();\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n      Site.Shapes.init();\n      Site.Map.init();\n    });\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n};\n\nSite.Menu = {\n  $headerItems: $('.header-menu-item'),\n  init: function() {\n    var _this = this;\n\n    _this.bind();\n  },\n\n  bind: function() {\n    var _this = this;\n\n    _this.$headerItems.on('click', function(e) {\n      _this.onItemClick(this, e);\n    });\n  },\n\n  onItemClick: function(item, event) {\n    var _this = this;\n\n    $('.header-menu-active').removeClass('header-menu-active');\n    $(item).addClass('header-menu-active');\n  }\n};\n\nSite.Shapes = {\n  currentState: 0,\n  maxState: 7,\n  timer: null,\n  interval: 12000,\n  init: function() {\n    var _this = this;\n\n    _this.setState();\n    _this.startInterval();\n  },\n\n  startInterval: function() {\n    var _this = this;\n\n    _this.timer = setInterval(function() {_this.setState();}, _this.interval);\n  },\n\n  nextState: function() {\n    var _this = this;\n\n    _this.currentState++;\n\n    if (_this.currentState > _this.maxState) {\n      _this.currentState = 1;\n    }\n\n    return _this.currentState;\n  },\n\n  setState: function() {\n    var _this = this;\n\n    $('#background-shape')\n    .removeClass('shape-state-' + _this.currentState)\n    .addClass('shape-state-' + _this.nextState());\n  },\n};\n\nSite.Map = {\n  panZoneSize: 100, // in pixels\n  distanceThreshold: 80, // percent of longest axis\n  thresholdRadious: false,\n  panning: false,\n  pan: {\n    up: false,\n    down: false,\n    left: false,\n    right: false,\n  },\n  window: {\n    width: 0,\n    height: 0,\n  },\n  mouse: {\n    x: 0,\n    y: 0,\n  },\n  center: {\n    width: 0,\n    height: 0,\n  },\n  mapPosition: false,\n\n  init: function() {\n    var _this =  this;\n\n    // Set windowSize\n    _this.getWindowSize();\n\n    // Set map element\n    _this.map = document.getElementById('map');\n\n    // init pan zones\n    _this.setPanZones();\n\n    // bind mouse position\n    document.addEventListener('mousemove', _this.handleMouseMove.bind(_this));\n\n    // detect mouse outside window\n    document.body.addEventListener('mouseleave', _this.noPan.bind(_this));\n  },\n\n  getWindowSize: function() {\n    var _this =  this;\n\n    _this.window.width = window.innerWidth;\n    _this.window.height = window.innerHeight;\n    _this.window.center = {\n      x: _this.window.width / 2,\n      y: _this.window.height / 2,\n    };\n\n  },\n\n  setPanZones: function() {\n    var _this =  this;\n\n    // Set threshold\n    if (_this.window.height / _this.window.width <= 1) { // Horizontal major axis or same size axis\n      _this.thresholdRadious = _this.window.height * (_this.distanceThreshold/100) / 2;\n    } else if (_this.window.width / _this.window.height > 1) { // Vertical major axis\n      _this.thresholdRadious = _this.window.width * (_this.distanceThreshold/100) / 2;\n    }\n\n  },\n\n  handleMouseMove: function(event) {\n    var _this =  this;\n\n    /*\n    var posX = event.clientX;\n    var posY = event.clientY;\n\n    _this.noPan();\n\n    if (posY > _this.panZones.up.max && posY < _this.panZones.down.min && posX > _this.panZones.left.max && posX < _this.panZones.right.min) { // not in a zone\n      _this.panning = false;\n    } else {\n      _this.panning = true;\n\n    // Check inside which zones\n      if (posY >= _this.panZones.up.min && posY <= _this.panZones.up.max) { //up\n        _this.pan.up = true;\n      }\n\n      if (posY >= _this.panZones.down.min && posY <= _this.panZones.down.max) { //down\n        _this.pan.down = true;\n      }\n\n      if (posX >= _this.panZones.left.min && posX <= _this.panZones.left.max) { //left\n        _this.pan.left = true;\n      }\n\n      if (posX >= _this.panZones.right.min && posX <= _this.panZones.right.max) { //right\n        _this.pan.right = true;\n      }\n\n      _this.triggerAnimation();\n    }\n\n*/\n\n    _this.mouse.x = event.clientX;\n    _this.mouse.y = event.clientY;\n\n    _this.triggerAnimation();\n\n  },\n\n  noPan: function() {\n    var _this =  this;\n\n    _this.pan =  {\n      up: false,\n      down: false,\n      left: false,\n      right: false,\n    };\n\n    _this.panning = false;\n\n  },\n\n  triggerAnimation: function() {\n    var _this =  this;\n\n    window.requestAnimationFrame(_this.animate.bind(_this));\n  },\n\n  animate: function() {\n    var _this =  this;\n\n    if (!_this.animate) {\n      return false;\n    }\n\n    // Check if above threshold\n    if (_this.distanceFromCenter() > _this.thresholdRadious) {\n      var angle = _this.angleFromCenter();\n      var distance = ( _this.distanceFromCenter() - _this.thresholdRadious) * 0.01;\n\n      if (!_this.mapPosition) {\n        _this.mapPosition = _this.getMapPosition();\n      }\n\n      _this.mapPosition[4] += distance * Math.cos(angle)\n      _this.mapPosition[5] += distance * Math.sin(angle)\n\n      _this.map.style.transform = 'matrix(' + _this.mapPosition.toString() + ')';\n\n      window.requestAnimationFrame(_this.animate.bind(_this));\n\n    }\n\n    /*\n\n    // Get current map position\n    if (!_this.mapPosition) {\n      _this.mapPosition = _this.getMapPosition();\n    }\n\n    // Move up\n    if (_this.pan.up && _this.mapPosition[5] <= 0) {\n      _this.mapPosition[5] = _this.mapPosition[5] + 0.1;\n    }\n\n    // Move down\n    if (_this.pan.down && _this.mapPosition[5] >= (_this.window.height * -2)) {\n      _this.mapPosition[5] = _this.mapPosition[5] - 0.1;\n    }\n\n    // Move left\n    if (_this.pan.left && _this.mapPosition[4] <= 0) {\n      _this.mapPosition[4] = _this.mapPosition[4] + 0.1;\n    }\n\n    // Move right\n    if (_this.pan.right && _this.mapPosition[4] >= (_this.window.width * -2)) {\n      _this.mapPosition[4] = _this.mapPosition[4] - 0.1;\n    }\n\n    _this.map.style.transform = 'matrix(' + _this.mapPosition.toString() + ')';\n    */\n\n    //console.log('angleFromCenter', _this.angleFromCenter());\n\n\n  },\n\n  distanceFromCenter: function() {\n    var _this = this;\n\n    var xs = Math.pow(_this.window.center.x - _this.mouse.x, 2);\n    var ys = Math.pow(_this.window.center.y - _this.mouse.y, 2);\n    var distance = Math.sqrt(xs + ys);\n\n    return distance;\n  },\n\n  angleFromCenter: function() {\n    var _this = this;\n\n    var dy = _this.window.center.y - this.mouse.y;\n    var dx = _this.window.center.x - this.mouse.x;\n\n    var theta = Math.atan2(dy, dx); // range (-PI, PI]\n\n    theta *= 180 / Math.PI; // rads to degs, range (-180, 180]\n\n    if (theta < 0) {\n      theta = 360 + theta; // range [0, 360)\n    }\n\n    return theta;\n  },\n\n  getMapPosition: function() {\n    var _this =  this;\n\n    // Get current element position (transform values)\n    var transformMatrix = getComputedStyle(this.map)['transform']; // Returns a string like \"matrix(0,0,0,0,0,0)\"\n\n    // Get only the values\n    transformMatrix = transformMatrix.replace('matrix(','').replace(')', ''); // Returns a string like \"0,0,0,0,0,0\"\n\n    // Make it into an array\n    return transformMatrix = transformMatrix.split(', ').map( function(item) {\n      return parseInt(item, 10);\n    }); // Returns an array like [0,0,0,0,0,0]\n  }\n};\n\nSite.init();\n"]}